Способы сегментации сети включают использование физических и логических методов для разделения сети на более мелкие, управляемые участки, что повышает безопасность, улучшает производительность и облегчает управление трафиком. Основные способы: 
1. VLAN (виртуальные локальные сети)
2. подсети (разделение диапазонов IP-адресов)
3. микросегментация (изоляция на уровне рабочих нагрузок)
4. межсетевые экраны для фильтрации трафика 
5. списки контроля доступа (ACL)


Традиционная сетевая инфраструктура
![[arh2.png]]

Что не устраивает в традиционной схеме?  

- Резкое снижение производительности при отказе на уровне агрегации;
- Недостаточная масштабируемость, вызываемая уровнем агрегации:  
    - MAC / ARP
    - VLAN'ы
    - перегруженность точек обмена горизонтальным трафиком;
- резкое возрастание сложности структуры при увеличении надежности;
- Множество проприетарных вариантов используемых протоколов (MLAG, vPC, варианты STP, UDLD, Bridge Assurance, LACP, FHRP, VRRP, HSRP, GLBP, VTP, MVRP...)
  
Решение? Как только мы начинаем говорить о масштабах, когда стоимость обслуживания начинает превосходить стоимость оборудования (да-да, столь любимые бухгалтерами и маркетологами, и нелюбимые остальными CAPEX и OPEX), как на сцену выходит давно известное решение в виде сетей Клоза (Clos fabric), известное также как архитектура **Leaf-Spine**.

![[arh3.png]]

Важное примечание для невнимательных: уровень Spine вовсе не идентичен уровню агрегации. На этом уровне нет и не предполагается горизонтальных связей между коммутаторами и уж тем более не предполагается, что весь трафик через этот уровень собирается и уходит в сторону ядра или, допустим, интернета.  
  
Сама по себе это архитектура известна уже полвека и успешно применяется в телефонных сетях, но сейчас сложились все предпосылки для ее активного внедрения в с сети ЦОД. С одной стороны, оборудование стало одновременно достаточно производительным и недорогим, при этом обеспечивая крайне малые задержки (сотни наносекунд — это уже не фантастика, а вполне реальность). Ну а с другой сами задачи стали такими, когда централизованная архитектура становится неоптимальной.  
  
Что же обеспечивает Leaf-Spine в приложении к рассматриваемым нами структурам?  

- Возможность опереться на ECMP (_который с марта 2014 однозначно определен и признан в качестве стандарта IEEE 802.1Qbp_) в условиях сплошной IP-фабрики;
- Облегчение устранения отказов оборудования за счет его однородности;
- Предсказуемая латентность;
- Отличая масштабируемость;
- Простота автоматизации управления;
- Меньшее падение пропускной способности сети при отказе оборудования;
- TOR (Top of Rack) вместо EOR (End of Row). _О специфике TOR и EOR можно почитать вот в этой [довольно старой, но по-прежнему актуальной статье](http://bradhedlund.com/2009/04/05/top-of-rack-vs-end-of-row-data-center-designs/))_

  
Бонусом:  

- Схема по умолчанию защищена от появления петель и не требует для этого STP;
- Если порт не отвечает — протокол маршрутизации считает его выпавшим и не рассматривает возможность его участия в маршрутах, в отличие от STP.
________________________________________________________________________
Paths: [[Networks]]
Tags: #Networks 